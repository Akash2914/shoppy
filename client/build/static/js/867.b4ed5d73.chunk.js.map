{"version":3,"file":"static/js/867.b4ed5d73.chunk.js","mappings":"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","sources":["common/confetti.js","pages/admin/product/ProductUpdate.js"],"sourcesContent":["import confetti from 'canvas-confetti'\n\nfunction randomInRange(min, max) {\n  min = Math.ceil(min)\n  max = Math.floor(max)\n  return Math.floor(Math.random() * (max - min + 1) + min)\n}\n\nexport const confettishow = () => {\n  confetti({\n    angle: randomInRange(55, 125),\n    spread: 360,\n    particleCount: 1200,\n    origin: { y: 0.6 },\n  })\n}\n","import React, { useState, useEffect } from 'react'\nimport {\n  AdminNav,\n  FormContainer,\n  ProductUpdateForm,\n  FileUpload,\n} from '../../../components'\nimport { confettishow } from '../../../common/confetti'\nimport { useSelector } from 'react-redux'\nimport { toast } from 'react-toastify'\nimport { getProductDetails, updateProduct } from '../../../api/product'\nimport { useNavigate, useParams } from 'react-router-dom'\nimport { getCategories, getCategorySubs } from '../../../api/category'\nimport { Button, Col, Container, Spinner, Row } from 'react-bootstrap'\nimport axios from 'axios'\nimport Avatar from 'react-avatar'\n\nconst initialValues = {\n  title: '',\n  description: '',\n  price: '',\n  category: '',\n  subCategory: [],\n  quantity: '',\n  images: [],\n  brand: '',\n}\n\nconst ProductUpdate = () => {\n  const [values, setValues] = useState(initialValues)\n  const [subOptions, setSubOptions] = useState([])\n  const [loading, setLoading] = useState(false)\n  const [showSub, setShowSub] = useState(false)\n  const [imageLoader, setImageLoader] = useState(false)\n  const [categories, setCategories] = useState([])\n  const [arrayofSubIds, setArrayofSubIds] = useState([])\n  const [selectedCategory, setSelectedCategory] = useState('')\n  const [PreviouslySubs, setPreviouslySubs] = useState([])\n\n  var list = []\n\n  if (PreviouslySubs) {\n    PreviouslySubs.map((p) => list.push(p._id))\n  }\n\n  // console.log(list)\n\n  const navigate = useNavigate()\n  let { slug } = useParams()\n\n  useEffect(() => {\n    loadAllCategories()\n    loadSingleProduct()\n  }, [])\n\n  const loadAllCategories = () => {\n    getCategories()\n      .then((res) => {\n        setCategories(res.data)\n      })\n      .catch((err) => {\n        toast.error('FETCHING CATEGORY ERROR')\n      })\n  }\n\n  const loadSingleProduct = () => {\n    setLoading(true)\n    getProductDetails(slug)\n      .then((res) => {\n        setLoading(false)\n        setValues({ ...values, ...res.data })\n        setPreviouslySubs(res.data.subCategory)\n        getCategorySubs(res.data.category._id).then((resp) => {\n          // console.log('asdsadsa', resp.data)\n          setSubOptions(resp.data) //on firstLoad\n        })\n        let arr = []\n        res.data.subCategory.map((s) => {\n          arr.push(s._id)\n        })\n        setArrayofSubIds((prev) => arr)\n        // console.log('AR***************', arr)\n      })\n      .catch((error) => {\n        setLoading(false)\n        // console.log(error.response.data)\n      })\n  }\n\n  // console.log('subop', subOptions)\n\n  //multiselect\n  const [field, setField] = useState([])\n\n  const { user } = useSelector((state) => ({ ...state }))\n\n  const handleChange = (e) => {\n    setValues({ ...values, [e.target.name]: e.target.value })\n  }\n\n  const handleRemoveImage = (public_id) => {\n    setImageLoader(true)\n    axios\n      .post(\n        `${process.env.REACT_APP_API}/deleteimage`,\n        { public_id },\n        {\n          headers: {\n            authtoken: user ? user.token : '',\n          },\n        }\n      )\n      .then((res) => {\n        setImageLoader(false)\n        const { images } = values\n        let filteredImages = images.filter((image) => {\n          return image.public_id !== public_id\n        })\n        setValues({ ...values, images: filteredImages })\n      })\n      .catch((err) => {\n        setImageLoader(false)\n        console.log(err)\n      })\n  }\n  const handleSubmit = (e) => {\n    setLoading(true)\n    e.preventDefault()\n    if (field.length == 0) {\n      values.subCategory = list\n    } else {\n      values.subCategory = field\n    }\n    if (selectedCategory) {\n      values.category = selectedCategory\n    } else {\n      values.category = values.category._id\n    }\n\n    updateProduct(slug, values, user.token)\n      .then((res) => {\n        setLoading(false)\n        confettishow()\n        toast.success(`${res.data.title} is Updated`)\n        navigate(-1)\n      })\n      .catch((err) => {\n        toast.error(err.response.data.err)\n      })\n  }\n\n  const handleCategoryChange = (e) => {\n    e.preventDefault()\n    // console.log(e.target.value)\n    setValues({ ...values, subCategory: [] })\n\n    setSelectedCategory(e.target.value)\n\n    if (e.target.value !== 'Please Select') {\n      setShowSub(true)\n      getCategorySubs(e.target.value)\n        .then((res) => {\n          // console.log(res.data)\n          setSubOptions(res.data)\n        })\n        .catch((err) => {\n          console.log('ERROR IN FETCHING CATEGORY REFRESH')\n        })\n    }\n\n    if (values.category._id === e.target.value) {\n      loadSingleProduct()\n      toast.error('Same Category Choosed')\n    }\n  }\n\n  return (\n    <>\n      {loading ? (\n        <h3 className=' text-center'>Loading</h3>\n      ) : (\n        <div className='container-fluid'>\n          <div className='row'>\n            <div className='col-md-2'>\n              <AdminNav />\n            </div>\n            <div className='col'>\n              <Container>\n                <Row className='d-flex justify-content-between'>\n                  {imageLoader ? (\n                    <Spinner animation='border' variant='danger' />\n                  ) : (\n                    <>\n                      {values.images &&\n                        values.images.map((image) => (\n                          <Col\n                            className='mb-3'\n                            sm={12}\n                            md={6}\n                            lg={4}\n                            xl={3}\n                            key={image.public_id}\n                          >\n                            <div\n                              className='item'\n                              style={{\n                                position: 'relative',\n                                paddingTop: '20px',\n                                display: 'inline-block',\n                              }}\n                            >\n                              <span\n                                className='notify-badge'\n                                style={{\n                                  position: 'absolute',\n                                  right: '-20px',\n                                  top: '10px',\n                                  background: 'red',\n                                  textAlign: 'center',\n                                  borderRadius: '30px',\n                                  color: 'white',\n                                  padding: '5px 10px',\n                                  fontSize: '20px',\n                                  cursor: 'pointer',\n                                }}\n                                onClick={() =>\n                                  handleRemoveImage(image.public_id)\n                                }\n                              >\n                                X\n                              </span>\n                              <Avatar round={true} src={image.url} />\n                            </div>\n                          </Col>\n                        ))}\n                    </>\n                  )}\n                </Row>\n              </Container>\n              <FormContainer>\n                <h2 className='text-center' style={{ color: 'black' }}>\n                  PRODUCT UPDATE\n                </h2>\n                {/* {JSON.stringify(values)} */}\n                <br />\n                <FileUpload\n                  values={values}\n                  setValues={setValues}\n                  setImageLoader={setImageLoader}\n                />{' '}\n                <br />\n                <ProductUpdateForm\n                  handleSubmit={handleSubmit}\n                  handleChange={handleChange}\n                  setValues={setValues}\n                  values={values}\n                  handleCategoryChange={handleCategoryChange}\n                  subOptions={subOptions}\n                  showSub={showSub}\n                  setField={setField}\n                  field={field}\n                  categories={categories}\n                  arrayofSubIds={arrayofSubIds}\n                  setArrayofSubIds={setArrayofSubIds}\n                  selectedCategory={selectedCategory}\n                />\n              </FormContainer>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  )\n}\n\nexport default ProductUpdate\n"],"names":["confettishow","min","max","confetti","angle","Math","ceil","floor","random","spread","particleCount","origin","y","initialValues","title","description","price","category","subCategory","quantity","images","brand","useState","values","setValues","subOptions","setSubOptions","loading","setLoading","showSub","setShowSub","imageLoader","setImageLoader","categories","setCategories","arrayofSubIds","setArrayofSubIds","selectedCategory","setSelectedCategory","PreviouslySubs","setPreviouslySubs","list","map","p","push","_id","navigate","useNavigate","slug","useParams","useEffect","loadAllCategories","loadSingleProduct","getCategories","then","res","data","catch","err","toast","getProductDetails","getCategorySubs","resp","arr","s","prev","error","field","setField","user","useSelector","state","className","animation","variant","image","sm","md","lg","xl","style","position","paddingTop","display","right","top","background","textAlign","borderRadius","color","padding","fontSize","cursor","onClick","public_id","axios","process","headers","authtoken","token","filteredImages","filter","console","log","round","src","url","handleSubmit","e","preventDefault","length","updateProduct","response","handleChange","target","name","value","handleCategoryChange"],"sourceRoot":""}